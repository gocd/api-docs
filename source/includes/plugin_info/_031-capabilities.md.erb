<%
    config_repo_capabilities_json =  {
      capabilities: {
        supports_pipeline_export: true,
        supports_parse_content: true,
        supports_list_config_files: false,
        supports_user_defined_properties: true
      }
}
%>

<%=
describe_sub_object 'The Config Repo Capabilities object', json: config_repo_capabilities_json, html_id: 'config-repo-capabilites-object' do
  supports_pipeline_export          'Boolean', 'Indicates if plugin supports pipeline configuration export.'
  supports_parse_content            'Boolean', 'Indicates if plugin supports parse content.'
  supports_list_config_files        'Boolean', 'Indicates if plugin supports listing of config files in the given repo.'
  supports_user_defined_properties  'Boolean', 'Indicates if plugin supports user defined configurations.'
end
%>

<%
    elastic_capabilities_json =  {
      capabilities: {
        supports_plugin_status_report: true,
        supports_agent_status_report: true,
        supports_cluster_status_report: true
      }
}
%>

<%=
describe_sub_object 'The Elastic Agents Capabilities object', json: elastic_capabilities_json, html_id: 'elastic-agent-capabilites-object' do
  supports_plugin_status_report  'Boolean', 'Indicates if plugin supports plugin level status report.'
  supports_agent_status_report   'Boolean', 'Indicates if plugin supports elastic agent status report for a specific agent.'
  supports_cluster_status_report 'Boolean', 'Indicates if plugin supports cluster profile status report for a specific agent.'
end
%>

<%
    authorization_capabilities_json =  {
      capabilities: {
        can_search: true,
        supported_auth_type: 'password',
        can_authorize: true
      }
}
%>

<%=
describe_sub_object 'The Authorization Capabilities object', json: authorization_capabilities_json, html_id: 'authorization-capabilites-object' do
  can_search          'Boolean', 'Indicates if plugin supports user search.'
  supported_auth_type 'String',  'Specifies the type of authentication supported, can be one of `password` or `web`'
  can_authorize       'Boolean', 'Indicates if plugin supports authorization.'
end
%>

<%
    analytics_capabilities_json =  {
      capabilities: {
        supported_analytics: [
          {
            type: "pipeline",
            id: "pipeline_duration",
            title: "Pipeline Duration"
          }
        ]
      }
}
%>

<%=
describe_sub_object 'The Analytics Capabilities object', json: analytics_capabilities_json, html_id: 'analytics-capabilites-object', desc: 'The analytics capablities contains a list of supported_analytics, with the following attributes.' do
  id    'String', 'Unique identifier for an analytics.'
  title 'String', 'Title for the analytics.'
  type  'String', 'The type of the analytics.'
end
%>
